(()=>{"use strict";var e={26:(e,t,o)=>{o.d(t,{Z:()=>a});const{PG_HOST:r,PG_DATABASE:s,PG_USERNAME:n,PG_PASSWORD:c}=process.env,a={database:{host:r,port:5432,database:s,user:n,password:c,ssl:{rejectUnauthorized:!1},connectionTimeoutMillis:5e3}}},833:(e,t,o)=>{o.d(t,{Z:()=>c});var r=o(723),s=o(26);const{database:n}=s.Z,c=new class{constructor(){this.result=null,console.log("db config: ",n)}async executeQuery(e){this.client=new r.Client(n),await this.client.connect();try{const{rows:t}=await this.client.query(e);console.log("received rows:",t),this.result=t}catch(e){throw console.error(e),e}finally{this.client.end(),console.log("connection closed")}return this.result}}},735:(e,t,o)=>{o.d(t,{O:()=>s}),o(43);var r=o(833);const s=async e=>{console.log("getProductsById lambda invocation with event:",e),console.log("Path Parameters:",e.pathParameters);const{productId:t}=e.pathParameters;console.log("product id :",t,typeof t);const o=`\n  SELECT *, stock.count\n    FROM products\n    LEFT JOIN stock ON products.id = stock.product_id\n    WHERE id = '${t}';\n  `;let s;try{s=await r.Z.executeQuery(o)}catch(e){return{statusCode:500,message:"Something went wrong"}}return 0===s.length?{statusCode:404,message:"Product not found"}:{statusCode:200,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0},body:JSON.stringify(s[0])}}},687:(e,t,o)=>{o.d(t,{o:()=>s}),o(43);var r=o(833);const s=async e=>{let t;console.log("getProductsList lambda invocation with event:",e);try{t=await r.Z.executeQuery("\n  SELECT *, stock.count\n    FROM products\n    LEFT JOIN stock ON products.id = stock.product_id;\n  ")}catch(e){return{statusCode:500,message:"Something went wrong"}}return 0===t.length?{statusCode:404,message:"Product not found"}:(console.log("products received from db: ",t),{statusCode:200,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":!0},body:JSON.stringify(t)})}},723:e=>{e.exports=require("pg")},43:e=>{e.exports=require("source-map-support/register")}},t={};function o(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{o.r(r),o.d(r,{getProductsList:()=>e.o,getProductsById:()=>t.O}),o(43);var e=o(687),t=o(735)})();var s=exports;for(var n in r)s[n]=r[n];r.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();
//# sourceMappingURL=handler.js.map